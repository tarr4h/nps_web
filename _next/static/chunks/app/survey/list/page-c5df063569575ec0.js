(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[150],{78681:(e,t,s)=>{Promise.resolve().then(s.bind(s,80872))},80872:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var r=s(95155),l=s(81252),a=s(12115),n=s(52363),i=s(6874),o=s.n(i),d=s(97357),c=s(91190),u=s(76221),x=s(17352),g=s(31167),h=s(59515);let m={":id":function(e){let{params:t}=e,[s,l]=(0,a.useState)(!1),[i,o]=(0,a.useState)(""),[m,p]=(0,a.useState)(""),[b,v]=(0,a.useState)(1),[f,j]=(0,a.useState)(n.Og.UNCLASSIFIED),{questions:y,handleAddQuestion:N,handleUpdateQuestion:w,handleRemoveQuestion:S,setQuestions:k}=(0,x.R)([]);(0,a.useEffect)(()=>{if(!(null==t?void 0:t.id))return;let e=(0,c.z$)(t.id);e&&(o(e.title||""),p(e.description||""),j(e.category||n.Og.UNCLASSIFIED),v(e.totalPages||1),e.questions&&k(e.questions.map(e=>({...e,isExpanded:!0}))))},[null==t?void 0:t.id,k]);let C=y.length>0?Math.max(b,...y.map(e=>e.page||1)):b,E=(0,a.useCallback)(e=>{if(!e.groupId)return"그룹";let t=y.find(t=>t.id===e.groupId);return(null==t?void 0:t.text)||"그룹"},[y]),I=(e,t)=>{w(e,t)},O=e=>{let t=y.find(t=>t.id===e);t&&w(e,{isExpanded:!t.isExpanded})};return(0,r.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"설문조사 편집기"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>{window.location.hash="/"},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"목록으로"}),(0,r.jsx)("button",{onClick:()=>{if(!i.trim())return void alert("설문지 제목을 입력해주세요.");(0,c.WF)({title:i.trim(),description:m.trim(),questions:y,totalPages:C,category:f},null==t?void 0:t.id),alert("설문지가 저장되었습니다.")},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"저장"}),(0,r.jsxs)("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 flex items-center",children:[(0,r.jsxs)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"미리보기"]})]})]}),(0,r.jsx)(g.X,{onAdd:N,onAddNewPage:()=>{let e=C+1;v(e),N(n.xi.SINGLE_CHOICE,e)},totalPages:C,onTotalPagesChange:v}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-gray-700 mb-1",children:"설문지 제목"}),(0,r.jsx)("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"설문지 제목을 입력하세요",value:i,onChange:e=>o(e.target.value)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-gray-700 mb-1",children:"설문지 설명 (선택)"}),(0,r.jsx)("textarea",{className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"설문지에 대한 설명을 입력하세요",value:m,onChange:e=>p(e.target.value)})]})]})]}),(0,r.jsx)("div",{className:"space-y-6",children:y.map((e,t)=>(0,r.jsx)(u.V,{question:e,index:t,onUpdate:t=>I(e.id,t),onRemove:()=>S(e.id),onToggleExpand:()=>O(e.id),renderEditor:e=>(0,r.jsx)(h.h,{question:e,questions:y,onUpdate:t=>I(e.id,t),onUpdateQuestionById:(e,t)=>I(e,t)}),getQuestionTypeName:e=>{switch(e){case n.xi.SINGLE_CHOICE:return"단일 선택";case n.xi.MULTIPLE_CHOICE:return"복수 선택";case n.xi.SIDE_BY_SIDE:return"병렬 비교";case n.xi.TEXT_ENTRY:return"텍스트 답변";case n.xi.GROUP:return"그룹";default:return""}},getGroupTitle:E},e.id))}),(0,r.jsx)(d.M,{isOpen:s,onClose:()=>l(!1),questions:y,onSave:e=>(0,c.WF)({...e,totalPages:C,category:f},null==t?void 0:t.id),totalPages:C})]})},"":function(e){let[t,s]=(0,a.useState)([]),[l,i]=(0,a.useState)(!0),[c,u]=(0,a.useState)(null),[x,g]=(0,a.useState)([]),[h,m]=(0,a.useState)(n.Og.UNCLASSIFIED),[p,b]=(0,a.useState)(n.P_.reduce((e,t)=>({...e,[t]:!0}),{})),[v,f]=(0,a.useState)(!1);(0,a.useEffect)(()=>{try{let e=JSON.parse(localStorage.getItem("savedSurveys")||"[]").map(e=>e.category?e:{...e,category:n.Og.UNCLASSIFIED});s(e),localStorage.setItem("savedSurveys",JSON.stringify(e))}catch(e){console.error("설문지 목록을 불러오는 중 오류가 발생했습니다:",e)}finally{i(!1)}},[]);let j=(0,a.useMemo)(()=>t.reduce((e,t)=>{let s=t.category||n.Og.UNCLASSIFIED;return e[s]||(e[s]=[]),e[s].push(t),e},{}),[t]),y=e=>{b(t=>({...t,[e]:!t[e]}))},N=e=>{g(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},w=e=>{var t;let s=(null==(t=j[e])?void 0:t.map(e=>e.id))||[];s.every(e=>x.includes(e))?g(e=>e.filter(e=>!s.includes(e))):g(e=>[...new Set([...e,...s])])},S=(e,r)=>{if(r.stopPropagation(),window.confirm("정말 이 설문지를 삭제하시겠습니까?")){let r=t.filter(t=>t.id!==e);s(r),localStorage.setItem("savedSurveys",JSON.stringify(r))}},k=e=>{u(e),f(!0)};return l?(0,r.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"저장된 설문지 목록"}),(0,r.jsx)(o(),{href:"/survey/settings",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"새 설문지 만들기"})]}),0===t.length?(0,r.jsxs)("div",{className:"text-center py-16 bg-gray-50 rounded-xl",children:[(0,r.jsx)("p",{className:"text-lg text-gray-600 mb-4",children:"저장된 설문지가 없습니다."}),(0,r.jsx)(o(),{href:"/survey/settings",className:"text-blue-600 hover:underline",children:"새 설문지 만들기"})]}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-8 p-4 bg-gray-50 rounded-lg flex items-center gap-4",children:[(0,r.jsx)("select",{value:h,onChange:e=>m(e.target.value),className:"p-2 border rounded-md",children:Object.values(n.Og).map(e=>(0,r.jsx)("option",{value:e,children:e},e))}),(0,r.jsxs)("button",{onClick:()=>{if(0===x.length)return void alert("이동할 설문지를 선택해주세요.");let e=t.map(e=>x.includes(e.id)?{...e,category:h}:e);s(e),localStorage.setItem("savedSurveys",JSON.stringify(e)),g([])},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400",disabled:0===x.length,children:["선택한 설문지 이동 (",x.length,")"]})]}),n.P_.map(e=>{let t=j[e];if(!t||0===t.length)return null;let s=t.every(e=>x.includes(e.id));return(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center p-4 bg-gray-100 rounded-t-lg cursor-pointer select-none",onClick:()=>y(e),children:[(0,r.jsx)("input",{type:"checkbox",className:"h-5 w-5 mr-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:s,onChange:()=>w(e),onClick:e=>e.stopPropagation()}),(0,r.jsx)("svg",{className:"w-5 h-5 mr-2 text-gray-600 transition-transform duration-200 ".concat(p[e]?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-800",children:[e," (",t.length,")"]})]}),p[e]&&(0,r.jsx)("div",{className:"p-4 border border-t-0 border-gray-200 rounded-b-lg",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>(0,r.jsxs)("div",{className:"relative bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow border border-gray-100 cursor-pointer",onClick:()=>k(e),children:[(0,r.jsx)("input",{type:"checkbox",checked:x.includes(e.id),onChange:()=>N(e.id),className:"absolute top-4 left-4 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",onClick:e=>e.stopPropagation()}),(0,r.jsxs)("div",{className:"p-6 pl-12",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-800 truncate",children:e.title}),(0,r.jsx)("span",{className:"text-xs text-gray-500 flex-shrink-0 ml-2",children:new Date(e.createdAt).toLocaleDateString()})]}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4 h-10 overflow-hidden",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-100",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:[e.questions.length,"개 질문"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),k(e)},className:"text-sm font-medium text-gray-600 hover:text-gray-500",children:"미리보기"}),(0,r.jsx)("a",{href:"#/".concat(e.id),onClick:e=>e.stopPropagation(),className:"text-sm font-medium text-blue-600 hover:text-blue-500",children:"수정"}),(0,r.jsx)("button",{onClick:t=>S(e.id,t),className:"text-sm font-medium text-red-600 hover:text-red-500",children:"삭제"})]})]})]})]},e.id))})})]},e)})]}),v&&c&&(0,r.jsx)(d.M,{isOpen:v,survey:c,questions:c.questions,totalPages:c.totalPages||(c.questions.length>0?Math.max(...c.questions.map(e=>e.page||1)):1),onClose:()=>f(!1)})]})}},p=()=>(0,r.jsx)("div",{children:"페이지를 찾을 수 없습니다."});function b(){return(0,r.jsx)(l.r,{routes:m,fallback:p})}},81252:(e,t,s)=>{"use strict";s.d(t,{r:()=>n});var r=s(95155),l=s(12115);let a=(e,t)=>{let s=[],r=e.replace(/([.+*?^[\]$|])/g,"\\$1").replace(/\((?!\?)/g,"(").replace(/\)/g,")").replace(/:([a-zA-Z0-9_]+)/g,(e,t)=>(s.push(t),"([^/]+)"));try{let l=t.match(new RegExp("^".concat(r,"$")));if(!l)return null;let a=l.slice(1).reduce((e,t,r)=>(e[s[r]]=t,e),{});return{route:e,params:a}}catch(t){return console.error("Invalid regex for pattern:",e,t),null}},n=e=>{let{routes:t,fallback:s}=e,[n,i]=(0,l.useState)(()=>window.location.hash.replace(/^#\/?/,"").split("?")[0]);(0,l.useEffect)(()=>{let e=()=>{i(window.location.hash.replace(/^#\/?/,"").split("?")[0])};return window.addEventListener("hashchange",e),e(),()=>{window.removeEventListener("hashchange",e)}},[]);let o=(0,l.useMemo)(()=>{for(let e of Object.keys(t).sort((e,t)=>t.length-e.length)){let s=a(e,n);if(s){let e=t[s.route],l={...s.params,params:s.params};return(0,r.jsx)(e,{...l})}}return s?(0,r.jsx)(s,{}):null},[n,t,s]);return(0,r.jsx)(r.Fragment,{children:o})}}},e=>{var t=t=>e(e.s=t);e.O(0,[641,874,957,633,441,684,358],()=>t(78681)),_N_E=e.O()}]);